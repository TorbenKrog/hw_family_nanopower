Version 4
SHEET 1 1904 1408
WIRE -1072 -256 -1184 -256
WIRE -944 -256 -1072 -256
WIRE -832 -256 -944 -256
WIRE 352 -256 240 -256
WIRE 480 -256 352 -256
WIRE 592 -256 480 -256
WIRE -1072 -240 -1072 -256
WIRE -832 -240 -832 -256
WIRE 240 -240 240 -256
WIRE 480 -240 480 -256
WIRE -1184 -128 -1184 -256
WIRE -944 -128 -944 -256
WIRE 352 -128 352 -256
WIRE 592 -128 592 -256
WIRE -1072 -112 -1072 -160
WIRE -1072 -112 -1136 -112
WIRE -832 -112 -832 -160
WIRE -832 -112 -896 -112
WIRE -816 -112 -832 -112
WIRE -720 -112 -736 -112
WIRE -544 -112 -656 -112
WIRE 32 -112 -544 -112
WIRE 64 -112 32 -112
WIRE 144 -112 128 -112
WIRE 240 -112 240 -160
WIRE 240 -112 224 -112
WIRE 304 -112 240 -112
WIRE 480 -112 480 -160
WIRE 544 -112 480 -112
WIRE -1232 -16 -1248 -16
WIRE -1184 -16 -1184 -32
WIRE -1184 -16 -1232 -16
WIRE -1072 -16 -1072 -112
WIRE -944 -16 -944 -32
WIRE -944 -16 -1072 -16
WIRE 352 -16 352 -32
WIRE 480 -16 480 -112
WIRE 480 -16 352 -16
WIRE 592 -16 592 -32
WIRE 640 -16 592 -16
WIRE 656 -16 640 -16
WIRE -1232 0 -1232 -16
WIRE -1072 0 -1072 -16
WIRE 480 0 480 -16
WIRE 640 0 640 -16
WIRE 160 32 144 32
WIRE -1232 96 -1232 80
WIRE -1072 96 -1072 80
WIRE -1072 96 -1232 96
WIRE 32 96 32 -112
WIRE 64 96 32 96
WIRE 144 96 144 32
WIRE 144 96 128 96
WIRE 160 96 144 96
WIRE 304 96 240 96
WIRE 480 96 480 80
WIRE 640 96 640 80
WIRE 640 96 480 96
WIRE -1072 128 -1184 128
WIRE -944 128 -1072 128
WIRE -832 128 -944 128
WIRE -1072 144 -1072 128
WIRE -832 144 -832 128
WIRE 160 160 144 160
WIRE 32 224 32 96
WIRE 64 224 32 224
WIRE 144 224 144 160
WIRE 144 224 128 224
WIRE 160 224 144 224
WIRE 304 224 304 96
WIRE 304 224 240 224
WIRE -1184 256 -1184 128
WIRE -944 256 -944 128
WIRE 672 256 672 240
WIRE -1072 272 -1072 224
WIRE -1072 272 -1136 272
WIRE -832 272 -832 224
WIRE -832 272 -896 272
WIRE -816 272 -832 272
WIRE -720 272 -736 272
WIRE -640 272 -656 272
WIRE -544 272 -544 -112
WIRE -544 272 -560 272
WIRE 160 288 144 288
WIRE -576 336 -576 320
WIRE 32 352 32 224
WIRE 64 352 32 352
WIRE 144 352 144 288
WIRE 144 352 128 352
WIRE 160 352 144 352
WIRE 304 352 304 224
WIRE 304 352 240 352
WIRE 672 352 672 336
WIRE -1232 368 -1248 368
WIRE -1184 368 -1184 352
WIRE -1184 368 -1232 368
WIRE -1072 368 -1072 272
WIRE -944 368 -944 352
WIRE -944 368 -1072 368
WIRE -1232 384 -1232 368
WIRE -1072 384 -1072 368
WIRE -1232 480 -1232 464
WIRE -1072 480 -1072 464
WIRE -1072 480 -1232 480
WIRE -624 480 -624 320
WIRE -576 480 -576 416
WIRE -576 480 -624 480
WIRE -1072 512 -1184 512
WIRE -944 512 -1072 512
WIRE -832 512 -944 512
WIRE -1072 528 -1072 512
WIRE -832 528 -832 512
WIRE -1184 640 -1184 512
WIRE -944 640 -944 512
WIRE -1072 656 -1072 608
WIRE -1072 656 -1136 656
WIRE -832 656 -832 608
WIRE -832 656 -896 656
WIRE -816 656 -832 656
WIRE -720 656 -736 656
WIRE -640 656 -656 656
WIRE -544 656 -544 272
WIRE -544 656 -560 656
WIRE -576 720 -576 704
WIRE -1232 752 -1248 752
WIRE -1184 752 -1184 736
WIRE -1184 752 -1232 752
WIRE -1072 752 -1072 656
WIRE -944 752 -944 736
WIRE -944 752 -1072 752
WIRE -1232 768 -1232 752
WIRE -1072 768 -1072 752
WIRE -1232 864 -1232 848
WIRE -1072 864 -1072 848
WIRE -1072 864 -1232 864
WIRE -624 864 -624 704
WIRE -576 864 -576 800
WIRE -576 864 -624 864
WIRE -1072 896 -1184 896
WIRE -944 896 -1072 896
WIRE -832 896 -944 896
WIRE -432 896 -432 880
WIRE -1072 912 -1072 896
WIRE -832 912 -832 896
WIRE 160 976 144 976
WIRE -432 992 -432 976
WIRE -1184 1024 -1184 896
WIRE -944 1024 -944 896
WIRE -1072 1040 -1072 992
WIRE -1072 1040 -1136 1040
WIRE -832 1040 -832 992
WIRE -832 1040 -896 1040
WIRE -816 1040 -832 1040
WIRE -720 1040 -736 1040
WIRE -640 1040 -656 1040
WIRE -544 1040 -544 656
WIRE -544 1040 -560 1040
WIRE -112 1040 -544 1040
WIRE 64 1040 -112 1040
WIRE 144 1040 144 976
WIRE 144 1040 128 1040
WIRE 160 1040 144 1040
WIRE 272 1040 240 1040
WIRE -112 1072 -112 1040
WIRE -16 1088 -64 1088
WIRE -576 1104 -576 1088
WIRE -1232 1136 -1248 1136
WIRE -1184 1136 -1184 1120
WIRE -1184 1136 -1232 1136
WIRE -1072 1136 -1072 1040
WIRE -944 1136 -944 1120
WIRE -944 1136 -1072 1136
WIRE -1232 1152 -1232 1136
WIRE -1072 1152 -1072 1136
WIRE -1232 1248 -1232 1232
WIRE -1072 1248 -1072 1232
WIRE -1072 1248 -1232 1248
WIRE -624 1248 -624 1088
WIRE -576 1248 -576 1184
WIRE -576 1248 -624 1248
WIRE -112 1248 -112 1152
WIRE -64 1248 -64 1136
WIRE -64 1248 -112 1248
WIRE -16 1248 -16 1168
WIRE -16 1248 -64 1248
FLAG -1072 96 0
FLAG -1072 480 0
FLAG -1072 864 0
FLAG -1072 1248 0
FLAG -576 1248 0
FLAG -576 864 0
FLAG -576 480 0
FLAG 480 96 0
FLAG -1184 -256 Vbat
FLAG -1184 128 Vbat
FLAG -1184 512 Vbat
FLAG -1184 896 Vbat
FLAG 160 32 Buck1_EN
IOPIN 160 32 Out
FLAG 160 160 Buck2_EN
IOPIN 160 160 Out
FLAG 160 288 Buck[n]_EN
IOPIN 160 288 Out
FLAG 160 976 PMU_3V3_EN
IOPIN 160 976 Out
FLAG 272 1040 Vbat
FLAG -64 1248 0
FLAG -432 992 0
FLAG -432 880 Vbat
FLAG 592 -256 Vsun
FLAG -1248 -16 Bat1_EN
IOPIN -1248 -16 Out
FLAG -1248 368 Bat2_EN
IOPIN -1248 368 Out
FLAG -1248 752 Bat3_EN
IOPIN -1248 752 Out
FLAG -1248 1136 Bat4_EN
IOPIN -1248 1136 Out
FLAG 672 352 0
FLAG 672 240 Vsun
FLAG 304 96 Vsun
FLAG 656 -16 Batsw_EN
IOPIN 656 -16 Out
SYMBOL voltage -432 880 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value {Vbat}
SYMBOL pmos -896 -32 R180
SYMATTR InstName Q1
SYMATTR Value FDC5614P
SYMBOL pmos -1136 -32 R180
SYMATTR InstName Q2
SYMATTR Value FDC5614P
SYMBOL res -1056 -256 M0
SYMATTR InstName R3
SYMATTR Value {Rupper}
SYMBOL res -816 -256 M0
SYMATTR InstName R1
SYMATTR Value {Rupper}
SYMBOL res -1056 -16 M0
SYMATTR InstName R4
SYMATTR Value {Rlower}
SYMBOL res -1216 -16 M0
SYMATTR InstName Rload1
SYMATTR Value 10k
SYMBOL res -832 -128 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {Rlower}
SYMBOL diode -720 -128 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL pmos -896 352 R180
SYMATTR InstName Q3
SYMATTR Value FDC5614P
SYMBOL pmos -1136 352 R180
SYMATTR InstName Q4
SYMATTR Value FDC5614P
SYMBOL res -1056 128 M0
SYMATTR InstName R7
SYMATTR Value {Rupper}
SYMBOL res -816 128 M0
SYMATTR InstName R5
SYMATTR Value {Rupper}
SYMBOL res -1056 368 M0
SYMATTR InstName R8
SYMATTR Value {Rlower}
SYMBOL res -1216 368 M0
SYMATTR InstName Rload2
SYMATTR Value 10k
SYMBOL res -832 256 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {Rlower}
SYMBOL diode -720 256 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL pmos -896 736 R180
SYMATTR InstName Q5
SYMATTR Value FDC5614P
SYMBOL pmos -1136 736 R180
SYMATTR InstName Q6
SYMATTR Value FDC5614P
SYMBOL res -1056 512 M0
SYMATTR InstName R11
SYMATTR Value {Rupper}
SYMBOL res -816 512 M0
SYMATTR InstName R9
SYMATTR Value {Rupper}
SYMBOL res -1056 752 M0
SYMATTR InstName R12
SYMATTR Value {Rlower}
SYMBOL res -1216 752 M0
SYMATTR InstName Rload3
SYMATTR Value 10k
SYMBOL res -832 640 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {Rlower}
SYMBOL diode -720 640 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL pmos -896 1120 R180
SYMATTR InstName Q7
SYMATTR Value FDC5614P
SYMBOL pmos -1136 1120 R180
SYMATTR InstName Q8
SYMATTR Value FDC5614P
SYMBOL res -1056 896 M0
SYMATTR InstName R15
SYMATTR Value {Rupper}
SYMBOL res -816 896 M0
SYMATTR InstName R13
SYMATTR Value {Rupper}
SYMBOL res -1056 1136 M0
SYMATTR InstName R16
SYMATTR Value {Rlower}
SYMBOL res -1216 1136 M0
SYMATTR InstName Rload4
SYMATTR Value 10k
SYMBOL res -832 1024 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value {Rlower}
SYMBOL diode -720 1024 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL sw -656 1040 R270
SYMATTR InstName S1
SYMBOL sw -656 656 R270
SYMATTR InstName S2
SYMBOL sw -656 272 R270
SYMATTR InstName S3
SYMBOL voltage -576 1088 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value PULSE(0V 5V 25m 1n 1n 75m 100m 1)
SYMBOL voltage -576 704 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value PULSE(0V 5V 50m 1n 1n 50m 100m 1)
SYMBOL voltage -576 320 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value PULSE(0V 5V 75m 1n 1n 25m 100m 1)
SYMBOL pmos 304 -32 M180
SYMATTR InstName Q9
SYMATTR Value FDC5614P
SYMBOL pmos 544 -32 M180
SYMATTR InstName Q10
SYMATTR Value FDC5614P
SYMBOL res 464 -256 R0
SYMATTR InstName R17
SYMATTR Value {Rupper}
SYMBOL res 224 -256 R0
SYMATTR InstName R18
SYMATTR Value {Rupper}
SYMBOL res 464 -16 R0
SYMATTR InstName R19
SYMATTR Value {Rlower}
SYMBOL res 624 -16 R0
SYMATTR InstName Rload5
SYMATTR Value 10k
SYMBOL res 240 -128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value {Rlower}
SYMBOL diode 128 -128 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D5
SYMATTR Value 1N4148
SYMBOL diode 128 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D6
SYMATTR Value 1N4148
SYMBOL res 256 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value {Rpullup}
SYMBOL voltage 672 240 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value {Vsun}
SYMBOL sw -112 1168 R180
SYMATTR InstName S4
SYMBOL diode 128 1024 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D9
SYMATTR Value 1N4148
SYMBOL res 256 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName D24
SYMATTR Value {Rpullup}
SYMBOL diode 128 208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D7
SYMATTR Value 1N4148
SYMBOL res 256 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value {Rpullup}
SYMBOL diode 128 336 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D8
SYMATTR Value 1N4148
SYMBOL res 256 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value {Rpullup}
SYMBOL voltage -16 1072 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value PULSE(5V 0V 100m 1n 1n 100m 200m 1)
TEXT 80 512 Left 2 !.TRAN 200ms startup
TEXT 80 536 Left 2 !.PARAM Vbat=28.8V Vsun=19V Rupper=750k Rlower=1Meg Rpullup=1Meg
TEXT 80 488 Left 2 !.MODEL SW SW(Ron=1u Roff=100Meg Vt=2.5)
TEXT 80 600 Left 2 !.MEAS Ibat_pu AVG (I(D1)+I(R4))*1000000 FROM 180ms TO 190ms\n.MEAS Ibat_ks AVG (I(D1)+I(R4))*1000000 FROM 80ms TO 90ms
TEXT 80 664 Left 2 !.MEAS Ipmu_pu AVG I(D9)*1000000 FROM 180ms TO 190ms\n.MEAS Ipmu_ks AVG I(D9)*1000000 FROM 80ms TO 90ms
TEXT 80 728 Left 2 !.MEAS Iacu_pu AVG (I(D5)+I(R19)+6*I(D6))*1000000 FROM 180ms TO 190ms\n.MEAS Iacu_ks AVG (I(D5)+I(R19)+6*I(D6))*1000000 FROM 80ms TO 90ms
TEXT 80 792 Left 2 !.MEAS Ipu PARAM Ibat_pu + Ipmu_pu\n.MEAS Iks PARAM Ibat_ks + Ipmu_ks
RECTANGLE Normal 880 432 -80 -352 2
RECTANGLE Normal -1344 496 -656 112 2
RECTANGLE Normal -1344 112 -656 -272 2
RECTANGLE Normal -1344 880 -656 496 2
RECTANGLE Normal -1344 1264 -656 880 2
RECTANGLE Normal 384 912 48 1136 2
